<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ëŒ€ë©´ì˜ˆë°°Â·ê¸°ë„ì ë™ê·¸ë¼ë¯¸ ì¹´ìš´í„°</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body{font-family:system-ui, sans-serif; margin:0; padding:2rem; background:#f9fafb; color:#111827;}
    h1{font-size:1.5rem; margin-bottom:1rem;}
    textarea{width:100%; min-height:220px; padding:1rem; border:1px solid #d1d5db; border-radius:0.5rem; resize:vertical; background:#fff; box-sizing:border-box;}
    button{margin-top:1rem; padding:0.75rem 1.5rem; border:none; border-radius:0.5rem; font-size:1rem; cursor:pointer; background:#2563eb; color:#fff;}
    button:hover{background:#1d4ed8;}
    .results{margin-top:2rem; background:#fff; padding:1rem; border-radius:0.5rem; box-shadow:0 1px 3px rgba(0,0,0,0.1); white-space:pre-wrap;}
    .notice{font-size:0.9rem; color:#6b7280;}
  </style>
</head>
<body>
  <h1>ğŸ•Šï¸ 3íŒ€ ì˜ˆë°°/ê¸°ë„ì â­•ï¸ ì¹´ìš´í„°</h1>
  <p>ì ê²€í‘œ í…ìŠ¤íŠ¸ë¥¼ ë¶™ì—¬ë„£ê³  <strong>"ì¹´ìš´íŠ¸!"</strong>ë¥¼ ëˆ„ë¥´ë©´ ì•„ë˜ í˜•ì‹ìœ¼ë¡œ ê²°ê³¼ê°€ ì¶œë ¥ë©ë‹ˆë‹¤.</p>
  <p class="notice">â€» í˜•ì‹ ì˜ˆì‹œ â†“
1. ëŒ€ë©´ì˜ˆë°°
8ì‹œë°˜ 00ëª…(ì´ë¦„1 ì´ë¦„2)
... ì´í•©ì—” ì´ë¦„ ì—†ìŒ</p>

  <textarea id="input" placeholder="ì—¬ê¸°ì— í…ìŠ¤íŠ¸ë¥¼ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”..."></textarea>
  <button id="countBtn">ì¹´ìš´íŠ¸!</button>
  <div id="output" class="results" style="display:none;"></div>

<script>
const btn = document.getElementById('countBtn');
const output = document.getElementById('output');
btn.addEventListener('click', () => {
  // ì…ë ¥ í…ìŠ¤íŠ¸ì—ì„œ VS16 ì œê±°
  let text = document.getElementById('input').value.replace(/\uFE0F/g, '');
  if (!text.trim()) return;

  // ì´ˆê¸° ë°ì´í„° êµ¬ì¡°
  const faceTimes = { '8ì‹œë°˜': 0, '12ì‹œ': 0, '15ì‹œë°˜': 0, '19ì‹œë°˜': 0, 'ì›”10ì‹œ': 0, 'ì›”20ì‹œ': 0 };
  const faceNames = { '8ì‹œë°˜': [], '12ì‹œ': [], '15ì‹œë°˜': [], '19ì‹œë°˜': [], 'ì›”10ì‹œ': [], 'ì›”20ì‹œ': [] };
  const prayTimes = { 'ì£¼ì¼': 0, 'ì›”ìš”ì¼': 0 };
  const prayNames = { 'ì£¼ì¼': [], 'ì›”ìš”ì¼': [] };

  let section = '';
  let currentTime = '';
  let isMonday = false;

  text.split(/\n/).forEach(raw => {
    const line = raw.trim();
    // ì„¹ì…˜ ì „í™˜
    if (/^1\./.test(line) && line.includes('ëŒ€ë©´')) { section = 'face'; isMonday = false; currentTime = ''; return; }
    if (/^2\./.test(line) && line.includes('ê¸°ë„ì')) { section = 'pray'; currentTime = ''; return; }

    if (section === 'face') {
      if (line.startsWith('* ì›”ìš”ì¼')) { isMonday = true; return; }
      // ì‹œê°„ í—¤ë”
      const tMatch = line.match(/-\s*(\d{1,2}ì‹œ(?:ë°˜)?)/);
      if (tMatch) {
        currentTime = tMatch[1];
        if (isMonday && /^(10|20)ì‹œ$/.test(currentTime)) currentTime = 'ì›”' + currentTime;
        return;
      }
      // ë™ê·¸ë¼ë¯¸ ê°œìˆ˜
      const circles = (line.match(/â­•/g) || []).length;
      if (circles > 0 && currentTime && faceTimes.hasOwnProperty(currentTime)) {
        faceTimes[currentTime] += circles;
        // ì´ë¦„ ì¶”ì¶œ: + ê¸°í˜¸ ì•ë’¤ ê´€ê³„ì—†ì´ ì¹´ìš´íŠ¸ ì „ í•œê¸€ ì´ë¦„ë§Œ ì¶”ì¶œ
        const namePattern = /([ê°€-í£]+)(?:\([^)]*\))*(?=\+?â­•)/g;
        let m;
        while ((m = namePattern.exec(line)) !== null) {
          faceNames[currentTime].push(m[1]);
        }
      }
    }
    else if (section === 'pray') {
      if (line.startsWith('- ì£¼ì¼')) { currentTime = 'ì£¼ì¼'; return; }
      if (line.startsWith('- ì›”ìš”ì¼')) { currentTime = 'ì›”ìš”ì¼'; return; }
      const circles = (line.match(/â­•/g) || []).length;
      if (circles > 0 && currentTime && prayTimes.hasOwnProperty(currentTime)) {
        prayTimes[currentTime] += circles;
        const namePattern = /(?:\+)*([ê°€-í£]+)(?:\+)*(?=â­•)/g;
        let m;
        while ((m = namePattern.exec(line)) !== null) {
          prayNames[currentTime].push(m[1]);
        }
      }
    }
  });

  // ì´í•© ê³„ì‚°
  const faceTotal = Object.values(faceTimes).reduce((a, b) => a + b, 0);
  const prayTotal = Object.values(prayTimes).reduce((a, b) => a + b, 0);
  const grandTotal = faceTotal + prayTotal;

  // ê²°ê³¼ í¬ë§·
  let result = '1. ëŒ€ë©´ì˜ˆë°°\n';
  Object.keys(faceTimes).forEach(time => {
    const count = faceTimes[time];
    const names = faceNames[time].join(' ');
    result += `${time} ${count}ëª…${names ? `(${names})` : ''}\n`;
  });

  result += '\n2. ê¸°ë„ì\n';
  Object.keys(prayTimes).forEach(time => {
    const count = prayTimes[time];
    const names = prayNames[time].join(' ');
    result += `${time} ${count}ëª…${names ? `(${names})` : ''}\n`;
  });

  result += `\nì´í•©\nëŒ€ë©´ì˜ˆë°° ${faceTotal}ëª…\nê¸°ë„ì ${prayTotal}ëª…\nì „ì²´ ${grandTotal}ëª…`;

  output.textContent = result;
  output.style.display = 'block';
});
</script>
</body>
</html>

